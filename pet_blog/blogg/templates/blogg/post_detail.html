<!--blogg/post_detail.html-->
{% extends "blogg/base.html" %}

{% block title %} post detail {% endblock %}

{% block content %}        
    <div class="topic">
        <h3>Post</h3>
        <div class="text">{{ post.author }}</div>
            <div class="post-card">
                <div class="topic">{{ post.topic }}</div>
                <div class="header">{{post.header}}</div>
                <h3>{{post.text}}</h3>
                <small>{{post.created_at}}</small>
        

    <!--likes-->
    <div class="actions">
        {% if user.is_authenticated %}
            <a href="{% url 'blogg:toggle_like' post.id %}">                                
                {% if post.id in user_likes %}
                    üíîDislike
                {% else %}
                    ‚ù§Ô∏èLike
                {% endif %} 
            </a>
        {% else %}
            <span class="login_required">
                <a href="{% url 'account:login' %}">Login to like</a>
            </span>
        {% endif %}                    
        <p>Likes: {{ post.likes.count }}</p>
    </div> 
    <!--end likes-->   
            </div>    

    <!--Comments block-->
    {% if user.is_authenticated %}
        <form method="post" action="{% url 'blogg:add_comment' post.id %}"> 
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="fun-submit-button small ocean" onclick="handleSubmit(this)">
                <div class="sparkles"></div> send comment</button>
        </form>
    {% else %}
        <a href="{% url 'account:login' %}">Login</a>
    {% endif %}
    
    <hr>

    {% for comment in comments %}
        <p><b>{{ comment.author.username }}</b> | {{ comment.created_at|date:"M d, Y H:i" }}</p>
        <p>{{ comment.text|linebreaks }}</p>
    {% empty %}
        <p>No comments yet</p>
    {% endfor %}
            
    </div>            
{% endblock content %}    